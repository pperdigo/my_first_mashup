import { useEffect, useState } from 'react';

function CurrentSelections(props){
  const [selections, setSelections] = useState([])

  useEffect(()=>{
    getSelections();
  },[])

  function getSelections(){
      props.app.getList("CurrentSelections", (reply)=>{

          var selections = reply.qSelectionObject.qSelections;

          var currentSelections = [];

          selections.forEach(element => {
              currentSelections.push({
                  field: element.qField,
                  values: element.qSelected 
              })
          });

          setSelections(currentSelections)
          
      })

  }

  function clearField(field){
      props.app.field(field).clear();
  }

  
      var content = <div> No filters applied</div>;

      if(selections.length > 0){
          content = selections.map(item => {
              return <div className="selected-block">
                          <div className="current-information">
                              <div className="current-title-div">{item.field}</div>
                              <div className="filters-items">
                                  <div>
                                      {item.values}
                                  </div>
                                  <button onClick={()=>{clearField(item.field)}} className="x-clear-btn"><img src="" alt="" /></button>
                              </div>
                          </div>
                      </div>
          })
      }

      return (
      <div className="current-selections custom-font">
          {content}
      </div>);
  }

export default CurrentSelections